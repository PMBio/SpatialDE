

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SpatialDE.test &mdash; SpatialDE  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="SpatialDE.test_spatial_interactions" href="SpatialDE.test_spatial_interactions.html" />
    <link rel="prev" title="SpatialDE.spatial_patterns" href="SpatialDE.spatial_patterns.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SpatialDE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="SpatialDE.html">SpatialDE</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.fit.html">SpatialDE.fit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.fit.html#SpatialDE.fit"><code class="docutils literal notranslate"><span class="pre">fit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.fit_detailed.html">SpatialDE.fit_detailed</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.fit_detailed.html#SpatialDE.fit_detailed"><code class="docutils literal notranslate"><span class="pre">fit_detailed()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.fit_fast.html">SpatialDE.fit_fast</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.fit_fast.html#SpatialDE.fit_fast"><code class="docutils literal notranslate"><span class="pre">fit_fast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.fit_spatial_interactions.html">SpatialDE.fit_spatial_interactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.fit_spatial_interactions.html#SpatialDE.fit_spatial_interactions"><code class="docutils literal notranslate"><span class="pre">fit_spatial_interactions()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.read_spaceranger.html">SpatialDE.read_spaceranger</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.read_spaceranger.html#SpatialDE.read_spaceranger"><code class="docutils literal notranslate"><span class="pre">read_spaceranger()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.spatial_patterns.html">SpatialDE.spatial_patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.spatial_patterns.html#SpatialDE.spatial_patterns"><code class="docutils literal notranslate"><span class="pre">spatial_patterns()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">SpatialDE.test</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#SpatialDE.test"><code class="docutils literal notranslate"><span class="pre">test()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.test_spatial_interactions.html">SpatialDE.test_spatial_interactions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.test_spatial_interactions.html#SpatialDE.test_spatial_interactions"><code class="docutils literal notranslate"><span class="pre">test_spatial_interactions()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.tissue_segmentation.html">SpatialDE.tissue_segmentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.tissue_segmentation.html#SpatialDE.tissue_segmentation"><code class="docutils literal notranslate"><span class="pre">tissue_segmentation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.GP.html">SpatialDE.GP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.GP.html#SpatialDE.GP"><code class="docutils literal notranslate"><span class="pre">GP</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.GPControl.html">SpatialDE.GPControl</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.GPControl.html#SpatialDE.GPControl"><code class="docutils literal notranslate"><span class="pre">GPControl</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.SGPIPM.html">SpatialDE.SGPIPM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.SGPIPM.html#SpatialDE.SGPIPM"><code class="docutils literal notranslate"><span class="pre">SGPIPM</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.SpatialPatternParameters.html">SpatialDE.SpatialPatternParameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.SpatialPatternParameters.html#SpatialDE.SpatialPatternParameters"><code class="docutils literal notranslate"><span class="pre">SpatialPatternParameters</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.SpatialPatterns.html">SpatialDE.SpatialPatterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.SpatialPatterns.html#SpatialDE.SpatialPatterns"><code class="docutils literal notranslate"><span class="pre">SpatialPatterns</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.TissueSegmentation.html">SpatialDE.TissueSegmentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.TissueSegmentation.html#SpatialDE.TissueSegmentation"><code class="docutils literal notranslate"><span class="pre">TissueSegmentation</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.TissueSegmentationParameters.html">SpatialDE.TissueSegmentationParameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.TissueSegmentationParameters.html#SpatialDE.TissueSegmentationParameters"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationParameters</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="SpatialDE.TissueSegmentationStatus.html">SpatialDE.TissueSegmentationStatus</a><ul>
<li class="toctree-l3"><a class="reference internal" href="SpatialDE.TissueSegmentationStatus.html#SpatialDE.TissueSegmentationStatus"><code class="docutils literal notranslate"><span class="pre">TissueSegmentationStatus</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SpatialDE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="SpatialDE.html">SpatialDE</a></li>
      <li class="breadcrumb-item active">SpatialDE.test</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/SpatialDE.test.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="spatialde-test">
<h1>SpatialDE.test<a class="headerlink" href="#spatialde-test" title="Link to this heading">ÔÉÅ</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="SpatialDE.test">
<span class="sig-prename descclassname"><span class="pre">SpatialDE.</span></span><span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omnibus</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spatial_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'spatial'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_space</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sizefactors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_kernels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NegativeBinomial'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SpatialDE.test" title="Link to this definition">ÔÉÅ</a></dt>
<dd><p>Test for spatially variable genes.</p>
<p>Perform a score test to detect spatially variable genes in a spatial transcriptomics
dataset. Multiple kernels can be tested to detect genes with different spatial patterns and lengthscales.
The test uses a count-based likelihood and thus operates on raw count data. Two ways of handling multiple
kernels are implemented: omnibus and Cauchy combination. The Cauchy combination tests each kernel separately
and combines the p-values afterwards, while the omnibus test tests all kernels simultaneously. With multiple
kernels the omnibus test is faster, but may have slightly less statistical power than the Cauchy combination.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">AnnData</span></code></span>) ‚Äì The annotated data matrix.</p></li>
<li><p><strong>layer</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>) ‚Äì Name of the AnnData object layer to use. By default <code class="docutils literal notranslate"><span class="pre">adata.X</span></code> is used.</p></li>
<li><p><strong>omnibus</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) ‚Äì Whether to do an omnibus test.</p></li>
<li><p><strong>spatial_key</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) ‚Äì Key in <code class="docutils literal notranslate"><span class="pre">adata.obsm</span></code> where the spatial coordinates are stored.</p></li>
<li><p><strong>kernel_space</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code>]]]]</span>) ‚Äì <p>Kernels to test against. Dictionary with the name of the kernel function as key and list of
lengthscales (if applicable) as values. Currently, three kernel functions are known:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">SE</span></code>, the squared exponential kernel <span class="math notranslate nohighlight">\(k(\boldsymbol{x}^{(1)}, \boldsymbol{x}^{(2)}; l) = \exp\left(-\frac{\lVert \boldsymbol{x}^{(1)} - \boldsymbol{x}^{(2)} \rVert}{l^2}\right)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PER</span></code>, the periodic kernel <span class="math notranslate nohighlight">\(k(\boldsymbol{x}^{(1)}, \boldsymbol{x}^{(2)}; l) = \cos\left(2 \pi \frac{\sum_i (x^{(1)}_i - x^{(2)}_i)}{l}\right)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">linear</span></code>, the linear kernel <span class="math notranslate nohighlight">\(k(\boldsymbol{x}^{(1)}, \boldsymbol{x}^{(2)}) = (\boldsymbol{x}^{(1)})^\top \boldsymbol{x}^{(2)}\)</span></p></li>
</ul>
<p>By default, 5 squared exponential and 5 periodic kernels with lengthscales spanning the range of the
data will be used.</p>
</p></li>
<li><p><strong>sizefactors</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>]</span>) ‚Äì Scaling factors for the observations. Default to total read counts.</p></li>
<li><p><strong>stack_kernels</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>]</span>) ‚Äì When using the Cauchy combination, all tests can be performed in one operation by stacking
the kernel matrices. This leads to increased memory consumption, but will drastically improve runtime
on GPUs for smaller data sets. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code> for datasets with less than 2000 observations and
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p></li>
<li><p><strong>obs_dist</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Literal</span></code>[<code class="docutils literal notranslate"><span class="pre">'NegativeBinomial'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Normal'</span></code>]</span>) ‚Äì Distribution of the observations. If set as ‚ÄúNormal‚Äù, model the regression to have Gaussian mean field error with identity link function.</p></li>
<li><p><strong>use_cache</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span>) ‚Äì Whether to use a pre-computed distance matrix for all kernels instead of computing the distance
matrix anew for each kernel. Increases memory consumption, but is somewhat faster.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code>]]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>If <code class="docutils literal notranslate"><span class="pre">omnibus==True</span></code>, a tuple with a Pandas DataFrame as the first element and <code class="docutils literal notranslate"><span class="pre">None</span></code> as the second.
The DataFrame contains the results of the test for each gene, in particular p-values and BH-adjusted p-values.
Otherwise, a tuple of two DataFrames. The first contains the combined results, while the second contains results
from individual tests.</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="SpatialDE.spatial_patterns.html" class="btn btn-neutral float-left" title="SpatialDE.spatial_patterns" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="SpatialDE.test_spatial_interactions.html" class="btn btn-neutral float-right" title="SpatialDE.test_spatial_interactions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Ilia Kats, Valentine Svensson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>